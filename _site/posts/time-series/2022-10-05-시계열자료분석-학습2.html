<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="조윤호">
<meta name="dcterms.date" content="2022-10-05">

<title>Yun98 - (수업) 시계열 자료분석 실습 2</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../.././img/school-locker.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Yun98</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/jjyun98/R_locker/"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com"><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">(수업) 시계열 자료분석 실습 2</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">R</div>
                <div class="quarto-category">lesson</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>조윤호 </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">October 5, 2022</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="수업-시계열-자료분석-실습-2" class="level1">
<h1>(수업) 시계열 자료분석 실습 2</h1>
<p>평활법(MA, 단순지수, 이중지수, Holt-Winter)</p>
<div class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">'tidyverse'</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">'forecast'</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">'lmtest'</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">'TTR'</span>)<span class="co"># SMA</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">'data.table'</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">'gridExtra'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>kings <span class="ot">=</span> <span class="fu">scan</span>(<span class="st">"https://robjhyndman.com/tsdldata/misc/kings.dat"</span>, <span class="at">skip =</span> <span class="dv">3</span>) <span class="co"># 영국 왕 수명 데이터</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>kingstimeseries <span class="ot">=</span> <span class="fu">ts</span>(kings)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.ts</span>(kingstimeseries)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2022-10-05-시계열자료분석-학습2_files/figure-html/cell-4-output-1.png" class="img-fluid"></p>
</div>
</div>
<section id="moving-average" class="level2">
<h2 class="anchored" data-anchor-id="moving-average">Moving Average</h2>
<ul>
<li>윈도우 크기가 3인 Moving Averages<br> 원래 데이터에 평활한 거 같이 그려짐</li>
</ul>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>kingstimeseriesSMA3 <span class="ot">&lt;-</span> <span class="fu">SMA</span>(kingstimeseries, <span class="at">n =</span> <span class="dv">3</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.ts</span>(kingstimeseries)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(kingstimeseriesSMA3, <span class="at">col =</span> <span class="st">'red'</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">SMA</span>(kingstimeseriesSMA3, <span class="at">n =</span> <span class="dv">10</span>), <span class="at">col =</span> <span class="st">'blue'</span>, <span class="at">lty =</span> <span class="dv">2</span>) <span class="co"># window 10개짜리</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2022-10-05-시계열자료분석-학습2_files/figure-html/cell-5-output-1.png" class="img-fluid"></p>
</div>
</div>
<section id="다른-방법으로-그림-그리기" class="level3">
<h3 class="anchored" data-anchor-id="다른-방법으로-그림-그리기">다른 방법으로 그림 그리기</h3>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>tmp.dat <span class="ot">&lt;-</span> <span class="fu">data.table</span>(<span class="at">kings =</span> kings,</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">t =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(kings))</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>tmp.dat[, sma3 <span class="sc">:</span><span class="er">=</span> <span class="fu">SMA</span>(kingstimeseries, <span class="at">n =</span> <span class="dv">3</span>)]</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>tmp.dat[, sma10 <span class="sc">:</span><span class="er">=</span> <span class="fu">SMA</span>(kingstimeseries, <span class="at">n =</span> <span class="dv">10</span>)]</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(tmp.dat, <span class="fu">aes</span>(t, kings)) <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="at">col =</span> <span class="st">'skyblue'</span>) <span class="sc">+</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_point</span>(<span class="at">col =</span> <span class="st">'steelblue'</span>) <span class="sc">+</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2022-10-05-시계열자료분석-학습2_files/figure-html/cell-6-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>melt.tmp <span class="ot">&lt;-</span> <span class="fu">melt</span>(tmp.dat, <span class="at">id =</span> <span class="st">'t'</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(melt.tmp, <span class="fu">aes</span>(t, value, <span class="at">col =</span> variable, <span class="at">size =</span> variable, <span class="at">lty =</span> variable)) <span class="sc">+</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="fu">labs</span>(<span class="at">col =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="fu">scale_linetype_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">'solid'</span>, <span class="st">'twodash'</span>, <span class="st">'dashed'</span>)) <span class="sc">+</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">'black'</span>, <span class="st">'orange'</span>, <span class="st">'steelblue'</span>)) <span class="sc">+</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="fu">scale_size_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">1.2</span>, <span class="fl">1.2</span>)) <span class="sc">+</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="fu">guides</span>(<span class="at">lty =</span> <span class="st">'none'</span>, <span class="at">size =</span> <span class="st">'none'</span>) <span class="sc">+</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning message:
“Removed 11 row(s) containing missing values (geom_path).”</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="2022-10-05-시계열자료분석-학습2_files/figure-html/cell-7-output-2.png" class="img-fluid"></p>
</div>
</div>
<ul>
<li>모형을 평가하는 수치들<br> 위의 3개는 window를 3개 가져갔을 때의 MSE들<br> 아래 3개는 window를 10개 가져갔을 때의 MSE들</li>
</ul>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>((tmp.dat<span class="sc">$</span>kings<span class="sc">-</span> tmp.dat<span class="sc">$</span>sma3)<span class="sc">^</span><span class="dv">2</span>, <span class="at">na.rm=</span>T) <span class="do">##MSE</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">abs</span>(tmp.dat<span class="sc">$</span>kings<span class="sc">-</span> tmp.dat<span class="sc">$</span>sma3), <span class="at">na.rm=</span>T) <span class="do">##MAE</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">abs</span>((tmp.dat<span class="sc">$</span>kings<span class="sc">-</span> tmp.dat<span class="sc">$</span>sma3)<span class="sc">/</span>tmp.dat<span class="sc">$</span>kings), <span class="at">na.rm=</span>T)<span class="sc">*</span><span class="dv">100</span> <span class="do">##MAPE</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>((tmp.dat<span class="sc">$</span>kings<span class="sc">-</span> tmp.dat<span class="sc">$</span>sma10)<span class="sc">^</span><span class="dv">2</span>, <span class="at">na.rm=</span>T) <span class="do">##MSE</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">abs</span>(tmp.dat<span class="sc">$</span>kings<span class="sc">-</span> tmp.dat<span class="sc">$</span>sma10), <span class="at">na.rm=</span>T) <span class="do">##MAE</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">abs</span>((tmp.dat<span class="sc">$</span>kings<span class="sc">-</span> tmp.dat<span class="sc">$</span>sma10)<span class="sc">/</span>tmp.dat<span class="sc">$</span>kings), <span class="at">na.rm=</span>T)<span class="sc">*</span><span class="dv">100</span> <span class="do">##MAPE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
128.752777777778
</div>
<div class="cell-output cell-output-display">
9.025
</div>
<div class="cell-output cell-output-display">
22.4739949863572
</div>
<div class="cell-output cell-output-display">
229.22
</div>
<div class="cell-output cell-output-display">
12.5272727272727
</div>
<div class="cell-output cell-output-display">
31.8798030034434
</div>
</div>
<ul>
<li>다른 자료</li>
</ul>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">scan</span>(<span class="st">'mindex.txt'</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>mindex <span class="ot">&lt;-</span> <span class="fu">ts</span>(z, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1986</span>, <span class="dv">1</span>), <span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>mindex</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
<caption>A Time Series: 9 × 12</caption>
<thead>
    <tr><th></th><th scope="col">Jan</th><th scope="col">Feb</th><th scope="col">Mar</th><th scope="col">Apr</th><th scope="col">May</th><th scope="col">Jun</th><th scope="col">Jul</th><th scope="col">Aug</th><th scope="col">Sep</th><th scope="col">Oct</th><th scope="col">Nov</th><th scope="col">Dec</th></tr>
</thead>
<tbody>
    <tr><th scope="row">1986</th><td> 9.3</td><td>10.7</td><td>13.3</td><td>14.1</td><td>17.8</td><td>18.1</td><td>19.4</td><td>18.8</td><td>19.1</td><td>18.4</td><td>18.0</td><td>17.0</td></tr>
    <tr><th scope="row">1987</th><td>19.5</td><td>20.1</td><td>19.4</td><td>15.7</td><td>15.6</td><td>16.1</td><td>14.9</td><td>16.0</td><td>14.6</td><td>18.3</td><td>18.2</td><td>23.0</td></tr>
    <tr><th scope="row">1988</th><td>22.2</td><td>22.1</td><td>18.8</td><td>17.7</td><td>13.8</td><td>12.7</td><td>16.5</td><td>15.6</td><td>16.3</td><td>10.7</td><td>10.4</td><td> 7.0</td></tr>
    <tr><th scope="row">1989</th><td> 4.7</td><td> 4.5</td><td> 4.0</td><td> 6.0</td><td> 6.2</td><td> 5.7</td><td> 4.4</td><td> 4.2</td><td> 5.0</td><td> 5.8</td><td> 6.4</td><td> 4.9</td></tr>
    <tr><th scope="row">1990</th><td> 7.9</td><td> 8.2</td><td>11.8</td><td>10.0</td><td>11.1</td><td>11.7</td><td>12.4</td><td>15.2</td><td>14.0</td><td>15.2</td><td>12.9</td><td>18.0</td></tr>
    <tr><th scope="row">1991</th><td>14.4</td><td>12.7</td><td> 8.3</td><td>11.5</td><td>11.9</td><td>11.6</td><td>10.3</td><td> 8.5</td><td>11.6</td><td>12.3</td><td>14.5</td><td>11.1</td></tr>
    <tr><th scope="row">1992</th><td>11.8</td><td>12.4</td><td>12.7</td><td> 9.8</td><td>10.0</td><td>10.2</td><td> 9.6</td><td> 6.9</td><td> 5.3</td><td> 4.8</td><td> 4.6</td><td> 1.9</td></tr>
    <tr><th scope="row">1993</th><td> 3.8</td><td> 4.7</td><td> 7.7</td><td> 7.0</td><td> 7.2</td><td> 7.8</td><td> 8.6</td><td>11.4</td><td>10.7</td><td>11.8</td><td>11.3</td><td>16.0</td></tr>
    <tr><th scope="row">1994</th><td>13.2</td><td>12.0</td><td> 8.5</td><td>11.4</td><td>    </td><td>    </td><td>    </td><td>    </td><td>    </td><td>    </td><td>    </td><td>    </td></tr>
</tbody>
</table>
</div>
</div>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>tmp.dat <span class="ot">&lt;-</span> <span class="fu">data.table</span>(<span class="at">ind =</span> z,</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">t =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(z))</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>tmp.dat[, sma3 <span class="sc">:</span><span class="er">=</span> <span class="fu">SMA</span>(mindex, <span class="at">n =</span> <span class="dv">3</span>)]</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>tmp.dat[, sma10 <span class="sc">:</span><span class="er">=</span> <span class="fu">SMA</span>(mindex, <span class="at">n =</span> <span class="dv">10</span>)]</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(tmp.dat, <span class="fu">aes</span>(t, ind)) <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="at">col =</span> <span class="st">'skyblue'</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_point</span>(<span class="at">col =</span> <span class="st">'steelblue'</span>) <span class="sc">+</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2022-10-05-시계열자료분석-학습2_files/figure-html/cell-10-output-1.png" class="img-fluid"></p>
</div>
</div>
<ul>
<li>window 3개, 10개 나눠서 합쳐서 그리기</li>
</ul>
</section>
</section>
<section id="단순-지수-평활법" class="level2">
<h2 class="anchored" data-anchor-id="단순-지수-평활법">단순 지수 평활법</h2>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">scan</span>(<span class="st">"mindex.txt"</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>mindex <span class="ot">&lt;-</span> <span class="fu">ts</span>(z, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1986</span>, <span class="dv">1</span>), <span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>tmp.dat <span class="ot">&lt;-</span> <span class="fu">data.table</span>(<span class="at">day =</span> <span class="fu">seq.Date</span>(<span class="fu">as.Date</span>(<span class="st">"1986-01-01"</span>), </span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">by=</span><span class="st">'month'</span>, </span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">length.out=</span><span class="fu">length</span>(z)),</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">ind =</span> z)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(tmp.dat)</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(tmp.dat, <span class="fu">aes</span>(day, ind))<span class="sc">+</span><span class="fu">geom_line</span>(<span class="at">col=</span><span class="st">'skyblue'</span>) <span class="sc">+</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">col=</span><span class="st">'steelblue'</span>)<span class="sc">+</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Intermediate shipment index"</span>)<span class="sc">+</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">20</span>),</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
<caption>A data.table: 6 × 2</caption>
<thead>
    <tr><th scope="col">day</th><th scope="col">ind</th></tr>
    <tr><th scope="col">&lt;date&gt;</th><th scope="col">&lt;dbl&gt;</th></tr>
</thead>
<tbody>
    <tr><td>1986-01-01</td><td> 9.3</td></tr>
    <tr><td>1986-02-01</td><td>10.7</td></tr>
    <tr><td>1986-03-01</td><td>13.3</td></tr>
    <tr><td>1986-04-01</td><td>14.1</td></tr>
    <tr><td>1986-05-01</td><td>17.8</td></tr>
    <tr><td>1986-06-01</td><td>18.1</td></tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">
<p><img src="2022-10-05-시계열자료분석-학습2_files/figure-html/cell-11-output-2.png" class="img-fluid"></p>
</div>
</div>
<ul>
<li>평균 = level이라 표현함<br> 예를 들어) 상수평균모형같은 경우 level이 시간에 상관없이 일정하다.<br> 단순지수평활에서는 level이 국지적으로 비슷하지만 전체적으로 보면 변화한다.<br> alpha가 level을 평활할 때 쓰는 평활상수의미</li>
</ul>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="do">### 단순지수평활 alpha=0.9</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>HoltWinters는 단순지수, 이중지수, 계절평활 3가지 다 가능<br> 이번에는 단순지수평활이라 기울기, 계절성분을 안 쓸거라서 FALSE해줬음.</li>
</ul>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>fit0 <span class="ot">&lt;-</span> <span class="fu">HoltWinters</span>(mindex, </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">alpha =</span> <span class="fl">0.9</span>, <span class="co"># 레벨</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">beta =</span> <span class="cn">FALSE</span>, <span class="co"># 기울기에 대한 평활상수</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">gamma =</span> <span class="cn">FALSE</span>) <span class="co"># 계절성분에 대한 평활상수</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ls</span>(fit0) <span class="co"># 어떤 정보 값들 가지는 지 보여줌</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class="list-inline"><li>'alpha'</li><li>'beta'</li><li>'call'</li><li>'coefficients'</li><li>'fitted'</li><li>'gamma'</li><li>'seasonal'</li><li>'SSE'</li><li>'x'</li></ol>
</div>
</div>
<ul>
<li>그 중에서 SSE 보고싶어서 SSE 선택</li>
</ul>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>fit0<span class="sc">$</span>SSE</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
437.636076191925
</div>
</div>
<ul>
<li>ses는 단순지수 평활만 사용가능</li>
</ul>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>fit01 <span class="ot">&lt;-</span> <span class="fu">ses</span>(mindex, </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">alpha =</span> <span class="fl">0.9</span>, <span class="co"># 사실 알파 안써도 얘가 적당히 넣어주긴함</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">initial =</span> <span class="st">'simple'</span>,</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">h =</span> <span class="dv">10</span>) <span class="co"># 앞으로 몇 개 더 예측해줄지 개수 설정</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ls</span>(fit01)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class="list-inline"><li>'fitted'</li><li>'level'</li><li>'lower'</li><li>'mean'</li><li>'method'</li><li>'model'</li><li>'residuals'</li><li>'series'</li><li>'upper'</li><li>'x'</li></ol>
</div>
</div>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit01)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>
Forecast method: Simple exponential smoothing

Model Information:
Simple exponential smoothing 

Call:
 ses(y = mindex, h = 10, initial = "simple", alpha = 0.9) 

  Smoothing parameters:
    alpha = 0.9 

  Initial states:
    l = 9.3 

  sigma:  2.092
Error measures:
                     ME     RMSE      MAE       MPE     MAPE      MASE
Training set 0.02051593 2.091975 1.614844 -2.575694 16.57215 0.2947652
                    ACF1
Training set -0.01462494

Forecasts:
         Point Forecast    Lo 80    Hi 80       Lo 95    Hi 95
May 1994       11.14643 8.465459 13.82741  7.04623710 15.24663
Jun 1994       11.14643 7.539551 14.75332  5.63018345 16.66268
Jul 1994       11.14643 6.806897 15.48597  4.50968590 17.78318
Aug 1994       11.14643 6.181200 16.11167  3.55276359 18.74010
Sep 1994       11.14643 5.625970 16.66690  2.70361248 19.58925
Oct 1994       11.14643 5.121693 17.17117  1.93238821 20.36048
Nov 1994       11.14643 4.656482 17.63638  1.22090910 21.07196
Dec 1994       11.14643 4.222457 18.07041  0.55712575 21.73574
Jan 1995       11.14643 3.814079 18.47879 -0.06743481 22.36030
Feb 1995       11.14643 3.427276 18.86559 -0.65899942 22.95187</code></pre>
</div>
</div>
<ul>
<li><p>해석 : ME, RMSE … 등 알려줌.<br> Forecasts 보면 Point Forecast는 점 추정량으로서 각각의 level에 대한 예측값<br> 그 옆은 80% 신뢰수준으로 상한, 하한<br> 또 그 옆은 95% 신뢰수준으로 상한, 하한을 나타낸다.<br> 참고) Point Forecast가 전부 같은 값으로 나오는 이유는 예를 들어 100번째 데이터까지를 바탕으로 결과를 도출한다면<br> 어짜피 100개의 결과를 바탕으로 예측한 것이기에 바뀔 이유가 없다.<br> 하지만 신뢰구간은 시간이 지날수록 믿을 수 없는 값이 많아지기 때문에(변동 증가) 시간이 지남에 따라 구간이 커진다.</p></li>
<li><p>holt는 이중지수 평활에서 사용</p></li>
</ul>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>fit02 <span class="ot">&lt;-</span> <span class="fu">holt</span>(mindex, </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="fl">0.9</span>,</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">beta=</span><span class="dv">0</span>, <span class="co"># 기울기</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">phi=</span><span class="dv">0</span>,</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">initial =</span><span class="st">'simple'</span>,</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">h =</span> <span class="dv">10</span>)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ls</span>(fit02)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class="list-inline"><li>'fitted'</li><li>'level'</li><li>'lower'</li><li>'mean'</li><li>'method'</li><li>'model'</li><li>'residuals'</li><li>'series'</li><li>'upper'</li><li>'x'</li></ol>
</div>
</div>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit02)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>
Forecast method: Holt's method

Model Information:
Holt's method 

Call:
 holt(y = mindex, h = 10, initial = "simple", alpha = 0.9, beta = 0,  

 Call:
     phi = 0) 

  Smoothing parameters:
    alpha = 0.9 
    beta  = 0 
    phi   = 0 

  Initial states:
    l = 9.3 
    b = 1.4 

  sigma:  2.092
Error measures:
                     ME     RMSE      MAE       MPE     MAPE      MASE
Training set 0.02051593 2.091975 1.614844 -2.575694 16.57215 0.2947652
                    ACF1
Training set -0.01462494

Forecasts:
         Point Forecast    Lo 80    Hi 80       Lo 95    Hi 95
May 1994       11.14643 8.465459 13.82741  7.04623710 15.24663
Jun 1994       11.14643 7.539551 14.75332  5.63018345 16.66268
Jul 1994       11.14643 6.806897 15.48597  4.50968590 17.78318
Aug 1994       11.14643 6.181200 16.11167  3.55276359 18.74010
Sep 1994       11.14643 5.625970 16.66690  2.70361248 19.58925
Oct 1994       11.14643 5.121693 17.17117  1.93238821 20.36048
Nov 1994       11.14643 4.656482 17.63638  1.22090910 21.07196
Dec 1994       11.14643 4.222457 18.07041  0.55712575 21.73574
Jan 1995       11.14643 3.814079 18.47879 -0.06743481 22.36030
Feb 1995       11.14643 3.427276 18.86559 -0.65899942 22.95187</code></pre>
</div>
</div>
<ul>
<li>해석: HoltWinters의 경우 원래 Point Forecast의 첫 칸 비워져서 나오는데 여기서는 0을 일부러 넣어서 칸 맞춤<br></li>
</ul>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>fit_data <span class="ot">&lt;-</span> <span class="fu">data.table</span>(</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">fit_HoltWinters =</span> <span class="fu">c</span>(<span class="dv">0</span>,fit0<span class="sc">$</span>fitted[,<span class="st">'xhat'</span>]),</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">fit_ses =</span> fit01<span class="sc">$</span>fitted,</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">fit_holt =</span> fit02<span class="sc">$</span>fitted</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(fit_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
<caption>A data.table: 6 × 3</caption>
<thead>
    <tr><th scope="col">fit_HoltWinters</th><th scope="col">fit_ses</th><th scope="col">fit_holt</th></tr>
    <tr><th scope="col">&lt;dbl&gt;</th><th scope="col">&lt;ts&gt;</th><th scope="col">&lt;ts&gt;</th></tr>
</thead>
<tbody>
    <tr><td> 0.00000</td><td> 9.30000</td><td> 9.30000</td></tr>
    <tr><td> 9.30000</td><td> 9.30000</td><td> 9.30000</td></tr>
    <tr><td>10.56000</td><td>10.56000</td><td>10.56000</td></tr>
    <tr><td>13.02600</td><td>13.02600</td><td>13.02600</td></tr>
    <tr><td>13.99260</td><td>13.99260</td><td>13.99260</td></tr>
    <tr><td>17.41926</td><td>17.41926</td><td>17.41926</td></tr>
</tbody>
</table>
</div>
</div>
<section id="여러-평할지수에-따른-변화" class="level3">
<h3 class="anchored" data-anchor-id="여러-평할지수에-따른-변화">여러 평할지수에 따른 변화</h3>
<ul>
<li>평활지수 0.2, 0.9썼을 때 평활이 얼마나 달라지나?</li>
</ul>
<div class="cell" data-tags="[]" data-execution_count="19">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>tmp.dat[, ses_0<span class="fl">.2</span> <span class="sc">:</span><span class="er">=</span> <span class="fu">ses</span>(mindex, <span class="at">alpha =</span> <span class="fl">0.2</span>)<span class="sc">$</span>fitted]</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>tmp.dat[, ses_0<span class="fl">.9</span> <span class="sc">:</span><span class="er">=</span> <span class="fu">ses</span>(mindex, <span class="at">alpha =</span> <span class="fl">0.9</span>)<span class="sc">$</span>fitted]</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>melt.tmp <span class="ot">&lt;-</span> <span class="fu">melt</span>(tmp.dat, <span class="at">id=</span><span class="st">'day'</span>)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(melt.tmp, <span class="fu">aes</span>(day, value, <span class="at">col=</span>variable, <span class="at">size=</span>variable, <span class="at">lty=</span>variable))<span class="sc">+</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">""</span>)<span class="sc">+</span><span class="fu">ylab</span>(<span class="st">""</span>)<span class="sc">+</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">'solid'</span>,<span class="st">"dashed"</span>,<span class="st">"dashed"</span> ))<span class="sc">+</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">'black'</span>,<span class="st">'orange'</span>, <span class="st">'steelblue'</span>))<span class="sc">+</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="fl">0.2</span>,<span class="fl">1.2</span>,<span class="fl">1.2</span>))<span class="sc">+</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">lty =</span> <span class="st">'none'</span>, <span class="at">size=</span><span class="st">'none'</span>)<span class="sc">+</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.85</span>,<span class="fl">0.8</span>)) <span class="sc">+</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">linetype=</span><span class="st">"solid"</span>, </span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">colour =</span><span class="st">"darkblue"</span>))<span class="sc">+</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2022-10-05-시계열자료분석-학습2_files/figure-html/cell-20-output-1.png" class="img-fluid"></p>
</div>
</div>
<section id="최적-평활상수-구하기" class="level4">
<h4 class="anchored" data-anchor-id="최적-평활상수-구하기">최적 평활상수 구하기</h4>
<ul>
<li>최적의 평활상수 = SSE를 최소화 시켜주는 값</li>
</ul>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>w <span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fu">seq</span>(<span class="fl">0.1</span>,<span class="fl">0.8</span>,<span class="fl">0.1</span>), </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>      <span class="fu">seq</span>(<span class="fl">0.81</span>, <span class="fl">0.99</span>, <span class="fl">0.01</span>)) <span class="co"># weight</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>sse <span class="ot">&lt;-</span> <span class="fu">sapply</span>(w, <span class="cf">function</span>(x) </span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">sum</span>(<span class="fu">ses</span>(mindex, <span class="at">alpha =</span> x)<span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>sse <span class="sc">%&gt;%</span> head</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class="list-inline"><li>1459.64469255637</li><li>1010.03396147245</li><li>768.279992410308</li><li>630.729514475135</li><li>547.181483975014</li><li>494.617442566588</li></ol>
</div>
</div>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>w[<span class="fu">which.min</span>(sse)]  <span class="co"># 최적 평활상수값</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>fit1 <span class="ot">&lt;-</span> <span class="fu">ses</span>(mindex, <span class="at">alpha=</span>w[<span class="fu">which.min</span>(sse)], <span class="at">h=</span><span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
0.9
</div>
</div>
<p><code>-</code> 예측모형 plot</p>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>w1 <span class="ot">=</span> w[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>)]  <span class="co"># xaxis from 0.7 to 1.0</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>sse1 <span class="ot">=</span> sse[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>)]</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(w1,sse1, <span class="at">type=</span><span class="st">"o"</span>, <span class="at">xlab=</span><span class="st">"weight"</span>, <span class="at">ylab=</span><span class="st">"sse"</span>, <span class="at">pch=</span><span class="dv">16</span>,</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">"Sum of squares of prediction error after 1 lag"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2022-10-05-시계열자료분석-학습2_files/figure-html/cell-24-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="잔차" class="level4">
<h4 class="anchored" data-anchor-id="잔차">잔차</h4>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(<span class="fu">resid</span>(fit1), <span class="at">mu=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>
    One Sample t-test

data:  resid(fit1)
t = 0.088676, df = 99, p-value = 0.9295
alternative hypothesis: true mean is not equal to 0
95 percent confidence interval:
 -0.3985116  0.4357973
sample estimates:
 mean of x 
0.01864288 </code></pre>
</div>
</div>
<ul>
<li>해당 ses의 잔차 출력한 것에 평균 0인지 t.test검증</li>
</ul>
<ol type="1">
<li>alpha = 0.9</li>
</ol>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit1, <span class="at">xlab=</span><span class="st">""</span>, <span class="at">ylab=</span><span class="st">""</span>, </span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">"Intermediate Goods Shipment Index and Simple Exponential Smoothing Value alpha=0.9"</span>, </span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">lty=</span><span class="dv">1</span>,<span class="at">col=</span><span class="st">"black"</span> )</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">fitted</span>(fit1), <span class="at">col=</span><span class="st">"red"</span>, <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">"Mindex"</span>, <span class="st">"alpha=0.9"</span>), </span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,<span class="at">col=</span><span class="fu">c</span>(<span class="st">"black"</span>,<span class="st">"red"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2022-10-05-시계열자료분석-학습2_files/figure-html/cell-26-output-1.png" class="img-fluid"></p>
</div>
</div>
<ul>
<li>마지막 보면 파란색 줄로 쭉 이어지는게 더 이상 추가해줄 데이터가 없어서 예측이 같게 이어지는 거임.<br> 하지만 시간이 지남에 따라 신뢰구간은 늘어나기에 범위적으로 늘어나는 표현이 일어남<br> 마지막 자세히 보면 빨간 점선이 검은 선보다 아래에 있다. alpha = 0.9라는 것은 최근 실제 정보를 9만큼, 예측값을 1만큼 내분한 점을 표현하는 것이기에<br> 보면 파란색 줄은 검은선보다 10%정도만큼 살짝 내려온 곳에 위치하게 된다.</li>
</ul>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit1<span class="sc">$</span>residuals, <span class="at">ylab=</span><span class="st">"residual"</span>,</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">"Time Series Plot of Prediction Errors : alpha=0.9"</span>); <span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2022-10-05-시계열자료분석-학습2_files/figure-html/cell-27-output-1.png" class="img-fluid"></p>
</div>
</div>
<ol start="2" type="1">
<li>alpha = 0.2</li>
</ol>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>fit2 <span class="ot">&lt;-</span> <span class="fu">ses</span>(mindex, <span class="at">alpha=</span><span class="fl">0.2</span>, <span class="at">h=</span><span class="dv">6</span>) </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit2, <span class="at">xlab=</span><span class="st">"year"</span>, <span class="at">ylab=</span><span class="st">"mindex"</span>, </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">"Intermediate Goods Shipment Index and Simple Exponential Smoothing Value alpha=0.2"</span>, </span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">lty=</span><span class="dv">1</span>,<span class="at">col=</span><span class="st">"black"</span>)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">fitted</span>(fit2), <span class="at">col=</span><span class="st">"red"</span>, <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">"Mindex"</span>,<span class="st">"alpha=0.2"</span>), </span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,<span class="at">col=</span><span class="fu">c</span>(<span class="st">"black"</span>,<span class="st">"red"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2022-10-05-시계열자료분석-학습2_files/figure-html/cell-28-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit2<span class="sc">$</span>residuals, <span class="at">ylab=</span><span class="st">"residual"</span>,</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">"Time Series Plot of Prediction Errors : alpha=0.2"</span>); <span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2022-10-05-시계열자료분석-학습2_files/figure-html/cell-29-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="두-모형의-비교" class="level3">
<h3 class="anchored" data-anchor-id="두-모형의-비교">두 모형의 비교</h3>
<div class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">rbind</span>(<span class="fu">accuracy</span>(fit1), <span class="fu">accuracy</span>(fit2)), <span class="at">digit=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
<caption>A matrix: 2 × 7 of type dbl</caption>
<thead>
    <tr><th></th><th scope="col">ME</th><th scope="col">RMSE</th><th scope="col">MAE</th><th scope="col">MPE</th><th scope="col">MAPE</th><th scope="col">MASE</th><th scope="col">ACF1</th></tr>
</thead>
<tbody>
    <tr><th scope="row">Training set</th><td> 0.019</td><td>2.092</td><td>1.616</td><td> -2.596</td><td>16.589</td><td>0.295</td><td>-0.015</td></tr>
    <tr><th scope="row">Training set</th><td>-0.162</td><td>3.178</td><td>2.595</td><td>-13.104</td><td>30.650</td><td>0.474</td><td> 0.736</td></tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="추정된-alpha를-이용한-단순지수평활" class="level3">
<h3 class="anchored" data-anchor-id="추정된-alpha를-이용한-단순지수평활">추정된 alpha를 이용한 단순지수평활</h3>
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>fit3 <span class="ot">&lt;-</span> <span class="fu">ses</span>(mindex,<span class="at">h=</span><span class="dv">6</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>fit3<span class="sc">$</span>model</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Simple exponential smoothing 

Call:
 ses(y = mindex, h = 6) 

  Smoothing parameters:
    alpha = 0.9031 

  Initial states:
    l = 9.4594 

  sigma:  2.1131

     AIC     AICc      BIC 
614.1310 614.3810 621.9466 </code></pre>
</div>
</div>
<ul>
<li>alpha 따로 입력안하면 알아서 최적으로 생각하는 alpha 입력해줌<br> 여기서는 Smoothing parameters : alpha = 0.9031로 해줌.</li>
</ul>
<div class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit3, <span class="at">xlab=</span><span class="st">""</span>, <span class="at">ylab=</span><span class="st">""</span>, <span class="at">main=</span><span class="st">""</span>,</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>     <span class="co"># main="중간재 출하지수와 단순지수평활값 : alpha estimated", </span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span><span class="st">"black"</span>)</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(fit3<span class="sc">$</span>fitted, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">"Mindex"</span>,<span class="st">"estimated alpha"</span>), </span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,<span class="at">col=</span><span class="fu">c</span>(<span class="st">"black"</span>,<span class="st">"red"</span>))</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit3<span class="sc">$</span>residuals, <span class="at">ylab=</span><span class="st">"residual"</span>,  </span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">"Time Series Plot of Prediction Errors : estimated alpha"</span>); <span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2022-10-05-시계열자료분석-학습2_files/figure-html/cell-32-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="2022-10-05-시계열자료분석-학습2_files/figure-html/cell-32-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="이중-지수-평활법" class="level2">
<h2 class="anchored" data-anchor-id="이중-지수-평활법">이중 지수 평활법</h2>
<div class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">scan</span>(<span class="st">"stock.txt"</span>) </span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>stock <span class="ot">&lt;-</span> <span class="fu">ts</span>(z, <span class="at">start=</span><span class="fu">c</span>(<span class="dv">1984</span>,<span class="dv">1</span>), <span class="at">frequency=</span><span class="dv">12</span>)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>tmp.data <span class="ot">&lt;-</span> <span class="fu">data.table</span>(</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">day =</span> <span class="fu">seq.Date</span>(<span class="fu">as.Date</span>(<span class="st">"1984-01-01"</span>), </span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">by=</span><span class="st">'month'</span>, <span class="at">length.out=</span><span class="fu">length</span>(z)),</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">z=</span>z  </span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(tmp.data, <span class="fu">aes</span>(day, z)) <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="at">col=</span><span class="st">'skyblue'</span>) <span class="sc">+</span></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">col=</span><span class="st">'steelblue'</span>)<span class="sc">+</span></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># scale_x_date(date_breaks = "1 year", date_labels = "%Y-%m") +</span></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"monthly stock index"</span>)<span class="sc">+</span></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">20</span>),</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2022-10-05-시계열자료분석-학습2_files/figure-html/cell-33-output-1.png" class="img-fluid"></p>
</div>
</div>
<ul>
<li>전체적으로 증가하는 추세라고 볼 수도 있지만 증가하다가 감소하다 다시 잠잠해지는<br> 즉, 일반적인 선형추세모형을 사용하기는 어렵다.</li>
</ul>
<div class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.ts</span>(stock, <span class="at">main =</span> <span class="st">'monthly stock index'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2022-10-05-시계열자료분석-학습2_files/figure-html/cell-34-output-1.png" class="img-fluid"></p>
</div>
</div>
<section id="모수-이중지수평활" class="level3">
<h3 class="anchored" data-anchor-id="모수-이중지수평활">1모수 이중지수평활</h3>
<ul>
<li>alpha, beta 동일하게 사용하므로 1모수</li>
</ul>
<div class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>fit4 <span class="ot">=</span> <span class="fu">holt</span>(stock, <span class="at">alpha=</span><span class="fl">0.6</span>, <span class="at">beta=</span><span class="fl">0.6</span>, <span class="at">h=</span><span class="dv">6</span>) </span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>fit4<span class="sc">$</span>model</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Holt's method 

Call:
 holt(y = stock, h = 6, alpha = 0.6, beta = 0.6) 

  Smoothing parameters:
    alpha = 0.6 
    beta  = 0.6 

  Initial states:
    l = 115.6009 
    b = 6.8098 

  sigma:  40.2546

     AIC     AICc      BIC 
1149.575 1149.836 1157.268 </code></pre>
</div>
</div>
<div class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit4, <span class="at">ylab=</span><span class="st">""</span>, <span class="at">xlab=</span><span class="st">""</span>,  <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span><span class="st">"black"</span>,</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">"Stock index and double exponential smoothing: alpha=beta=0.6"</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>     )</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">fitted</span>(fit4), <span class="at">col=</span><span class="st">"red"</span>, <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>, <span class="at">lty=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="st">"black"</span>,<span class="st">"red"</span>), <span class="fu">c</span>(<span class="st">"Index"</span>, <span class="st">"Double"</span>), <span class="at">bty =</span> <span class="st">"n"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2022-10-05-시계열자료분석-학습2_files/figure-html/cell-36-output-1.png" class="img-fluid"></p>
</div>
</div>
<ul>
<li>뒤에 예측한 것을 보면 마지막 시점에서 추세가 아래로 내려가고 있으므로 쭉 내려가는 것으로 예측이 된거임.<br> 딱히 예측에 좋은 거 같지는 않음.</li>
</ul>
<div class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">resid</span>(fit4), <span class="at">main=</span><span class="st">"Time series plot of forecasting error"</span>); <span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2022-10-05-시계열자료분석-학습2_files/figure-html/cell-37-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="이중지수평활-alpha-beta-추정" class="level3">
<h3 class="anchored" data-anchor-id="이중지수평활-alpha-beta-추정">이중지수평활 alpha, beta 추정</h3>
<ul>
<li>alpha, beta 선택하지 않으면 알아서 선택해서 돌려줌.</li>
</ul>
<div class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>fit5 <span class="ot">=</span> <span class="fu">holt</span>(stock, <span class="at">h=</span><span class="dv">6</span>)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>fit5<span class="sc">$</span>model</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Holt's method 

Call:
 holt(y = stock, h = 6) 

  Smoothing parameters:
    alpha = 0.9999 
    beta  = 0.1071 

  Initial states:
    l = 124.1137 
    b = 3.4954 

  sigma:  31.8609

     AIC     AICc      BIC 
1108.677 1109.343 1121.498 </code></pre>
</div>
</div>
<ul>
<li><p>여기서는 0.999, 0.1로 선택됨.</p></li>
<li><p>beta를 0.6으로 쓸 때보다는 기울기가 훨씬 완만한 모습을 보인다.</p></li>
</ul>
<div class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit5, <span class="at">ylab=</span><span class="st">"Index"</span>, <span class="at">xlab=</span><span class="st">"year"</span>,  <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span><span class="st">"black"</span>,</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">"Intermediate Goods Shipment Index and Double Exponential Smoothing Value : alpha, beta estimated"</span>)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">fitted</span>(fit5), <span class="at">col=</span><span class="st">"red"</span>, <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>, <span class="at">lty=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="st">"black"</span>,<span class="st">"red"</span>), <span class="fu">c</span>(<span class="st">"Index"</span>, <span class="st">"Double"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2022-10-05-시계열자료분석-학습2_files/figure-html/cell-39-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">resid</span>(fit5), <span class="at">main=</span><span class="st">"Time series plot of forecasting error: alpha, beta estimated"</span>)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2022-10-05-시계열자료분석-학습2_files/figure-html/cell-40-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="holt-winters-method계절" class="level2">
<h2 class="anchored" data-anchor-id="holt-winters-method계절">Holt-Winters Method(계절)</h2>
<p><code>-</code> 항공사 데이터 사용</p>
<div class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">scan</span>(<span class="st">"koreapass.txt"</span>)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>pass <span class="ot">&lt;-</span> <span class="fu">ts</span>(z, <span class="at">start=</span><span class="fu">c</span>(<span class="dv">1981</span>,<span class="dv">1</span>), <span class="at">frequency=</span><span class="dv">12</span>) </span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.ts</span>(pass)</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>tmp.data <span class="ot">&lt;-</span> <span class="fu">data.table</span>(</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">day =</span> <span class="fu">seq.Date</span>(<span class="fu">as.Date</span>(<span class="st">"1981-01-01"</span>), </span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">by=</span><span class="st">'month'</span>, <span class="at">length.out=</span><span class="fu">length</span>(z)),</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">z=</span>z  </span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2022-10-05-시계열자료분석-학습2_files/figure-html/cell-41-output-1.png" class="img-fluid"></p>
</div>
</div>
<ul>
<li>보면 분산이 점점 증가하는 형태이기에 평활모형에서 승법모형을 사용해야 한다. or 로그변환한 가법모형사용</li>
</ul>
<section id="holt-winters-additive-model" class="level3">
<h3 class="anchored" data-anchor-id="holt-winters-additive-model">Holt Winters additive model</h3>
<ul>
<li>가법이면 <code>seasonal="additive"</code><br> 승법이면 <code>seasonal="multiplicative"</code></li>
</ul>
<div class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>fit6 <span class="ot">=</span> <span class="fu">hw</span>(pass, <span class="at">seasonal=</span><span class="st">"additive"</span>, <span class="at">h=</span><span class="dv">12</span>) <span class="co"># 1년 예측이라 12</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>fit6<span class="sc">$</span>model</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Holt-Winters' additive method 

Call:
 hw(y = pass, h = 12, seasonal = "additive") 

  Smoothing parameters:
    alpha = 0.5963 
    beta  = 0.0177 
    gamma = 1e-04 

  Initial states:
    l = 129763.5823 
    b = 799.4119 
    s = -29016.96 -855.2679 13617.18 -4624.62 37697.04 16768.22
           9720.317 14214.29 317.4589 -5632.175 -31459.7 -20745.79

  sigma:  11509.58

     AIC     AICc      BIC 
2542.155 2548.955 2587.751 </code></pre>
</div>
</div>
<ul>
<li>alpha, beta, gamma 따로 입력하지 않았으므로 알아서 해줌.</li>
</ul>
<div class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit6,  <span class="at">ylab=</span><span class="st">"passenger"</span>, <span class="at">xlab=</span><span class="st">"year"</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span><span class="st">"blue"</span>,</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">"Winters Additive Seasonal Exponential plot of Smooth Material"</span>)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(fit6<span class="sc">$</span>fitted, <span class="at">col=</span><span class="st">"red"</span>, <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>, <span class="at">lty=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="st">"blue"</span>,<span class="st">"red"</span>), <span class="fu">c</span>(<span class="st">"Pass"</span>, <span class="st">"Additive"</span>),  <span class="at">bty =</span> <span class="st">"n"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2022-10-05-시계열자료분석-학습2_files/figure-html/cell-43-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ts.plot</span>(<span class="fu">resid</span>(fit6), <span class="at">ylab=</span><span class="st">"residual"</span>, </span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">main=</span><span class="st">"Prediction error of additive model"</span>); <span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2022-10-05-시계열자료분석-학습2_files/figure-html/cell-44-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dwtest</span>(<span class="fu">lm</span>(<span class="fu">resid</span>(fit6)<span class="sc">~</span><span class="dv">1</span>), <span class="at">alternative =</span> <span class="st">'two.sided'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>
    Durbin-Watson test

data:  lm(resid(fit6) ~ 1)
DW = 2.0779, p-value = 0.683
alternative hypothesis: true autocorrelation is not 0</code></pre>
</div>
</div>
<ul>
<li>더빈왓슨에서 ~1의 형태로 하면 상수평활형태로 결과 나옴.<br> 여튼저튼 잔차 그 자체의 결과로 나오게 됨.</li>
</ul>
</section>
<section id="holt-winters-multiplicative-model" class="level3">
<h3 class="anchored" data-anchor-id="holt-winters-multiplicative-model">Holt Winters multiplicative model</h3>
<div class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>fit7<span class="ot">=</span> <span class="fu">hw</span>(pass, <span class="at">seasonal=</span><span class="st">"multiplicative"</span>,<span class="at">h=</span><span class="dv">12</span>) </span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>fit7<span class="sc">$</span>model</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Holt-Winters' multiplicative method 

Call:
 hw(y = pass, h = 12, seasonal = "multiplicative") 

  Smoothing parameters:
    alpha = 0.4231 
    beta  = 0.1209 
    gamma = 0.0014 

  Initial states:
    l = 128311.2252 
    b = 914.1471 
    s = 0.8553 0.9918 1.0572 0.9742 1.1913 1.0935
           1.0469 1.0668 0.9952 0.9699 0.8389 0.9189

  sigma:  0.051

     AIC     AICc      BIC 
2506.102 2512.902 2551.699 </code></pre>
</div>
</div>
<div class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit7,  <span class="at">ylab=</span><span class="st">"passenger"</span>, <span class="at">xlab=</span><span class="st">"year"</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span><span class="st">"blue"</span>,</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">"Winters Time series plot of multiplicative seasonal exponential smoothed data"</span>)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(fit7<span class="sc">$</span>fitted, <span class="at">col=</span><span class="st">"red"</span>, <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>, <span class="at">lty=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="st">"blue"</span>,<span class="st">"red"</span>), <span class="fu">c</span>(<span class="st">"Pass"</span>, <span class="st">"Multiplicative"</span>),  <span class="at">bty =</span> <span class="st">"n"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2022-10-05-시계열자료분석-학습2_files/figure-html/cell-47-output-1.png" class="img-fluid"></p>
</div>
</div>
<ul>
<li>해석 : 가법모형에서는 예측 구간에서 앞에 있는 것을 붙여 놓은 것 마냥, 사실 분산이 점점 증가하고 있기에 예측 구간의 폭도 같이 늘어나야 하는데<br> 그렇지 못한 반면, 승법모형의 경우 분산이 커지는 것을 고려해서 진폭이 커지는 형태를 표현해준다.</li>
</ul>
<div class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ts.plot</span>(z<span class="sc">-</span>fit7<span class="sc">$</span>fitted, <span class="at">ylab=</span><span class="st">"residual"</span>, </span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">main=</span><span class="st">"Prediction error of multiplicative model"</span>); <span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2022-10-05-시계열자료분석-학습2_files/figure-html/cell-48-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dwtest</span>(<span class="fu">lm</span>(<span class="fu">resid</span>(fit7)<span class="sc">~</span><span class="dv">1</span>), <span class="at">alternative =</span> <span class="st">'two.sided'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>
    Durbin-Watson test

data:  lm(resid(fit7) ~ 1)
DW = 1.6079, p-value = 0.03973
alternative hypothesis: true autocorrelation is not 0</code></pre>
</div>
</div>
</section>
<section id="결론" class="level3">
<h3 class="anchored" data-anchor-id="결론">결론</h3>
<p>smoothing을 하려고 할 때 살펴 보아야 할 것<br> level만 있다면 -&gt; ses<br> trend가 있다면 -&gt; holt<br> seasonality가 있다면 -&gt; hw 그 중에서도 가법쓸 지, 승법 쓸 지</p>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>